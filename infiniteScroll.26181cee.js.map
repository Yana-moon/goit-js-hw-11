{"mappings":"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","sources":["src/infiniteScroll.js"],"sourcesContent":["import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport Notiflix from 'notiflix';\nimport axios from 'axios';\nimport scrollBy from './scrollBy.js';\n\n// ======================================\n\nconst API_KEY = '33912044-22b2651672bec86fc9e274e80';\nconst BASE_URL = 'https://pixabay.com/api';\nlet page = 1;\nlet per_page = 40;\nlet searchQuery = '';\nlet totalHits = 0;\nlet lightbox = '';\n\nasync function searchImage() {\nconst response = await axios.get(\n    `${BASE_URL}/?key=${API_KEY}&q=${searchQuery}&image_type=photo&per_page=${per_page}&page=${page}&orientation=horizontal&safesearch=true`\n);\ntotalHits = response.data.totalHits;\nnextPage();\nreturn response.data.hits;\n}\n\n// =========================================\n\nconst searchForm = document.querySelector('#search-form');\nconst gallery = document.querySelector('.gallery');\nconst submitBtn = document.querySelector('.submit');\nconst input = document.querySelector('#search-form > input');\n\nsearchForm.addEventListener('submit', onSearch);\nsearchForm.addEventListener('input', onSabmitBtn);\ninput.addEventListener('input', invalidInput);\n\nfunction invalidInput(e) {\nif (e.data === null) {\n    submitBtn.disabled = true;\n}\nreturn;\n}\n\nfunction onSabmitBtn(e) {\n  // console.log(e.currentTarget.elements.searchQuery.value);\nif (e.currentTarget.elements.searchQuery.value.trim().length !== 0) {\n    submitBtn.disabled = false;\n}\n}\n\nfunction ofSabmitBtn() {\nsubmitBtn.disabled = true;\n}\n\n// =========================================================\n\nconst loading = document.querySelector('.loading');\n\nwindow.addEventListener('scroll', infiniteScroll);\n\nfunction infiniteScroll() {\nconst { scrollTop, scrollHeight, clientHeight } = document.documentElement;\n\nconsole.log({ scrollTop, scrollHeight, clientHeight });\n\nif (clientHeight + scrollTop >= scrollHeight) {\n    showLoading();\n} else if (scrollHeight - scrollTop === clientHeight) {\n    galleryEndInfo();\n}\n}\n\nfunction showLoading() {\nloading.classList.add('show');\nsetTimeout(fetchImages, 500);\n}\n\nfunction showRemove() {\nloading.classList.remove('show');\n}\n\n// =======================================================\n\nasync function onSearch(e) {\ne.preventDefault();\n\nconst form = e.currentTarget;\nconst value = form.elements.searchQuery.value.trim();\nsearchQuery = value;\n\nonSabmitBtn(e);\ninvalidInput(e);\nresetPage();\nclearGallery();\nawait fetchImages().finally(() => form.reset());\nofSabmitBtn();\n}\n\nasync function fetchImages() {\ntry {\n    const images = await searchImage();\n    const markup = await images.reduce(\n    (markup, image) => createMarkup(image) + markup,\n    ''\n    );\n\n    appendImagesToGallery(markup);\n    lightbox.refresh();\n\n    if (totalHits > per_page && page - 1 !== 1) {\n    scrollBy();\n    }\n\n    if (totalHits === 0) {\n    Notiflix.Notify.failure(\n        'Sorry, there are no images matching your search query. Please try again.'\n    );\n    showRemove();\n    } else if (totalHits > 0 && page - 1 === 1) {\n    totalImages(totalHits);\n    galleryEndInfo();\n    showRemove();\n    } else {\n    galleryEndInfo();\n    showRemove();\n    }\n} catch (err) {\n    return console.error(err);\n}\n}\n\nfunction appendImagesToGallery(markup) {\ngallery.insertAdjacentHTML('beforeend', markup);\nlightBox();\n}\n\nfunction clearGallery() {\ngallery.innerHTML = '';\n}\n\n// ========================================================\n\nfunction createMarkup({\nlargeImageURL,\nwebformatURL,\ntags,\nlikes,\nviews,\ncomments,\ndownloads,\n}) {\nreturn `\n<a href=\"${largeImageURL}\">\n<div class=\"photo-card\">\n<img src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\n<div class=\"info\">\n    <p class=\"info-item\">\n    <b>Likes: </b>${likes}\n    </p>\n    <p class=\"info-item\">\n    <b>Views: </b>${views}\n    </p>\n    <p class=\"info-item\">\n    <b>Comments: </b>${comments}\n    </p>\n    <p class=\"info-item\">\n    <b>Downloads: </b>${downloads}\n    </p>\n</div>\n</div></a>\n`;\n}\n\n// ========================================================\n\nfunction nextPage() {\npage += 1;\n}\n\nfunction resetPage() {\npage = 1;\n}\n\nfunction lightBox() {\nlightbox = new SimpleLightbox('.gallery a', {\n    captionsData: 'alt',\n    captionDelay: 250,\n});\n}\n\nfunction totalImages(totalHits) {\nNotiflix.Notify.success(`Hooray! We found ${totalHits} images.`);\n}\n\nfunction galleryEndInfo() {\nif (totalHits / per_page < page - 1) {\n    showRemove();\n    Notiflix.Notify.success(\n    \"We're sorry, but you've reached the end of search results.\"\n    );\n}\n}"],"names":["$bpxeT","parcelRequire","$059fc1ddcc511c27$var$API_KEY","$059fc1ddcc511c27$var$BASE_URL","$059fc1ddcc511c27$var$page","$059fc1ddcc511c27$var$searchQuery","$059fc1ddcc511c27$var$totalHits","$059fc1ddcc511c27$var$lightbox","$059fc1ddcc511c27$var$searchImage","$059fc1ddcc511c27$var$_searchImage","apply","this","arguments","$parcel$interopDefault","$2TvXO","mark","_callee","response","$dIxxU","default","get","concat","_ctx","sent","data","totalHits","$059fc1ddcc511c27$var$nextPage","hits","$059fc1ddcc511c27$var$searchForm","document","querySelector","$059fc1ddcc511c27$var$gallery","$059fc1ddcc511c27$var$submitBtn","$059fc1ddcc511c27$var$input","$059fc1ddcc511c27$var$invalidInput","e","disabled","$059fc1ddcc511c27$var$onSabmitBtn","currentTarget","elements","searchQuery","value","trim","length","$059fc1ddcc511c27$var$ofSabmitBtn","addEventListener","$059fc1ddcc511c27$var$_onSearch","$059fc1ddcc511c27$var$loading","$059fc1ddcc511c27$var$showRemove","classList","remove","form","preventDefault","$059fc1ddcc511c27$var$resetPage","$059fc1ddcc511c27$var$clearGallery","$059fc1ddcc511c27$var$fetchImages","finally","reset","$059fc1ddcc511c27$var$_fetchImages","images","reduce","markup","image","$059fc1ddcc511c27$var$createMarkup","$059fc1ddcc511c27$var$appendImagesToGallery","refresh","$707g3","$6JpON","Notify","failure","$059fc1ddcc511c27$var$totalImages","$059fc1ddcc511c27$var$galleryEndInfo","console","error","t0","insertAdjacentHTML","$5IjG7","captionsData","captionDelay","innerHTML","param","largeImageURL","webformatURL","tags","likes","views","comments","downloads","totalHits1","success","window","_documentElement","documentElement","scrollTop","scrollHeight","clientHeight","log","add","setTimeout"],"version":3,"file":"infiniteScroll.26181cee.js.map"}